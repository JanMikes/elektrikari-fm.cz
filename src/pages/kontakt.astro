---
import BaseLayout from '../layouts/BaseLayout.astro';
import SectionTitle from '../components/SectionTitle.astro';
import { Phone, Mail, MapPin, Building2, FileText } from 'lucide-astro';
---

<BaseLayout
  title="Kontakt - Elektrikáři Frýdek-Místek | +420 773 477 006 | Poptávka elektro"
  description="Kontaktujte profesionální elektrikáře z Frýdku-Místku. Tel: +420 773 477 006, Email: Filip.koval@seznam.cz. Poptávka elektroinstalací, revizí a hromosvodů. Rychlá odpověď, kvalitní služby. Ostrava, Karviná, Opava."
  keywords="kontakt elektrikář Frýdek-Místek, poptávka elektroinstalace, telefon elektrikář, elektrikář kontakt, nabídka elektro služby, elektrikář Ostrava kontakt"
>
  <section class="py-8 md:py-14">
    <div class="container-custom">
      <SectionTitle title="Kontakt" subtitle="Jsme tu pro vás!" />

      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
        <!-- Contact Information -->
        <div class="space-y-8">
          <div class="prose prose-lg">
            <p class="text-gray-700">
              Máte dotaz, potřebujete poradit nebo poptat naše služby? Rádi vám zodpovíme všechny vaše otázky
              a pomůžeme vám s elektroinstalacemi, opravami či revizemi. Kontaktujte nás telefonicky, e-mailem
              nebo prostřednictvím kontaktního formuláře.
            </p>
            <p class="text-gray-700">
              Vaše spokojenost je pro nás prioritou a vždy se snažíme o co nejrychlejší odpověď!
            </p>
          </div>

          <div class="space-y-6">
            <h3 class="text-2xl font-bold text-primary-800">Kontaktní údaje</h3>

            <div class="card bg-primary-50 border-2 border-primary-200 space-y-6">
              <div class="flex items-start space-x-4">
                <div class="w-12 h-12 bg-primary-600 rounded-full flex items-center justify-center flex-shrink-0">
                  <Phone class="h-6 w-6 text-white" />
                </div>
                <div>
                  <p class="font-medium text-gray-600 text-sm">Telefon</p>
                  <a href="tel:+420773477006" class="text-2xl font-bold text-primary-700 hover:text-primary-800 transition-colors">
                    +420 773 477 006
                  </a>
                </div>
              </div>

              <div class="flex items-start space-x-4">
                <div class="w-12 h-12 bg-primary-600 rounded-full flex items-center justify-center flex-shrink-0">
                  <Mail class="h-6 w-6 text-white" />
                </div>
                <div>
                  <p class="font-medium text-gray-600 text-sm">E-mail</p>
                  <a href="mailto:Filip.koval@seznam.cz" class="text-xl font-bold text-primary-700 hover:text-primary-800 transition-colors break-all">
                    Filip.koval@seznam.cz
                  </a>
                </div>
              </div>

              <div class="flex items-start space-x-4">
                <div class="w-12 h-12 bg-primary-600 rounded-full flex items-center justify-center flex-shrink-0">
                  <MapPin class="h-6 w-6 text-white" />
                </div>
                <div>
                  <p class="font-medium text-gray-600 text-sm">Sídlo</p>
                  <p class="text-gray-800 font-medium">
                    Novodvorská 3074<br />
                    Frýdek-Místek 738 01<br />
                    Česká republika
                  </p>
                </div>
              </div>

              <div class="pt-4 border-t border-primary-300 space-y-2">
                <div class="flex items-center space-x-3">
                  <Building2 class="h-5 w-5 text-primary-600" />
                  <div>
                    <span class="font-medium text-gray-700">IČ:</span>
                    <span class="text-gray-900 ml-2">07431163</span>
                  </div>
                </div>
                <div class="flex items-center space-x-3">
                  <FileText class="h-5 w-5 text-primary-600" />
                  <div>
                    <span class="font-medium text-gray-700">DIČ:</span>
                    <span class="text-gray-900 ml-2">CZ9702235378</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Contact Form -->
        <div>
          <div class="card bg-gradient-to-br from-gray-50 to-primary-50 border-2 border-primary-200">
            <h3 class="text-2xl font-bold text-primary-800 mb-6">Kontaktní formulář</h3>

            <form id="contact-form" novalidate class="space-y-4">
              <div>
                <label for="name" class="block text-sm font-medium text-gray-700 mb-2">
                  Jméno <span class="text-red-500">*</span>
                </label>
                <input
                  type="text"
                  id="name"
                  name="name"
                  class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-primary-500 focus:ring focus:ring-primary-200 transition-colors"
                  required
                />
              </div>

              <div>
                <label for="email" class="block text-sm font-medium text-gray-700 mb-2">
                  E-mail <span class="text-red-500">*</span>
                </label>
                <input
                  type="email"
                  id="email"
                  name="email"
                  class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-primary-500 focus:ring focus:ring-primary-200 transition-colors"
                  required
                />
              </div>

              <div>
                <label for="phone" class="block text-sm font-medium text-gray-700 mb-2">
                  Telefon
                </label>
                <input
                  type="tel"
                  id="phone"
                  name="phone"
                  class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-primary-500 focus:ring focus:ring-primary-200 transition-colors"
                />
              </div>

              <div>
                <label for="message" class="block text-sm font-medium text-gray-700 mb-2">
                  Zpráva <span class="text-red-500">*</span>
                </label>
                <textarea
                  id="message"
                  name="message"
                  rows="5"
                  class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-primary-500 focus:ring focus:ring-primary-200 transition-colors resize-none"
                  required
                ></textarea>
              </div>

              <button
                type="submit"
                class="btn-primary w-full text-lg py-4"
              >
                Odeslat zprávu
              </button>

              <div id="form-message" class="hidden"></div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>

  <script>
    const form = document.getElementById("contact-form") as HTMLFormElement;
    const messageDiv = document.getElementById("form-message");

    form?.addEventListener("submit", async (event) => {
      event.preventDefault();

      // Clear previous messages and errors
      messageDiv?.classList.add("hidden");
      document.querySelectorAll(".border-red-500").forEach((el) => {
        el.classList.remove("border-red-500");
      });
      document.querySelectorAll(".text-red-500:not(span)").forEach((el) => {
        el.remove();
      });

      let isValid = true;
      const name = document.getElementById("name") as HTMLInputElement;
      const email = document.getElementById("email") as HTMLInputElement;
      const phone = document.getElementById("phone") as HTMLInputElement;
      const message = document.getElementById("message") as HTMLTextAreaElement;

      // Validation
      if (!name.value.trim()) {
        isValid = false;
        addError(name, "Prosím zadejte své jméno.");
      }

      if (!email.value.trim() || !/^\S+@\S+\.\S+$/.test(email.value)) {
        isValid = false;
        addError(email, "Prosím zadejte platný e-mail.");
      }

      if (!message.value.trim()) {
        isValid = false;
        addError(message, "Prosím zadejte svou zprávu.");
      }

      if (!isValid) return;

      // Prepare payload
      const payload = {
        apiKey: "sf_fjl3245fd70i6m1j88h85chb",
        name: name.value.trim(),
        email: email.value.trim(),
        replyTo: email.value.trim(),
        phone: phone.value.trim(),
        message: message.value.trim(),
        $source: "Web elektrikari-fm.cz",
      };

      try {
        // Disable submit button
        const submitBtn = form.querySelector('button[type="submit"]') as HTMLButtonElement;
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = "Odesílání...";

        const response = await fetch("https://api.staticforms.xyz/submit", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(payload),
        });

        if (response.ok) {
          showMessage("Vaše zpráva byla úspěšně odeslána. Děkujeme!", "success");
          form.reset();
        } else {
          const errorData = await response.json();
          showMessage(
            `Odeslání zprávy se nezdařilo. ${errorData.error || "Zkuste to prosím znovu později."}`,
            "error"
          );
        }

        // Re-enable submit button
        submitBtn.disabled = false;
        submitBtn.textContent = originalText || "";
      } catch (error) {
        showMessage("Došlo k chybě při odesílání zprávy. Zkuste to prosím znovu.", "error");
        const submitBtn = form.querySelector('button[type="submit"]') as HTMLButtonElement;
        submitBtn.disabled = false;
      }
    });

    function addError(element: HTMLElement, message: string) {
      element.classList.add("border-red-500");
      const error = document.createElement("p");
      error.className = "text-red-500 text-sm mt-1";
      error.textContent = message;
      element.parentNode?.appendChild(error);
    }

    function showMessage(text: string, type: "success" | "error") {
      if (!messageDiv) return;

      messageDiv.className = type === "success"
        ? "p-4 rounded-lg bg-green-100 border-2 border-green-500 text-green-800"
        : "p-4 rounded-lg bg-red-100 border-2 border-red-500 text-red-800";

      messageDiv.textContent = text;
      messageDiv.classList.remove("hidden");

      // Scroll to message
      messageDiv.scrollIntoView({ behavior: "smooth", block: "nearest" });
    }
  </script>
</BaseLayout>
